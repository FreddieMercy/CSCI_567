from unittest import TestCase
from work.utils import Distances


class TestUtilities(TestCase):
    def legacy_minkowski_distance(self, point1, point2):
        sum = 0
        for i in range(len(point1)):
            tmp = point1[i] - point2[i]
            tmp **= 3
            sum += tmp
        sum **= (1 / 3)
        return sum

    def AssertLists(self, left, right):
        self.assertIsNotNone(left)
        self.assertIsNotNone(right)
        self.assertEqual(len(right), len(left))

        for i in range(len(left)):
            self.assertEqual(right[i], left[i])


class test_KNN_Tests(TestUtilities):
    def test_minkowski_distance_Test1(self):
        point1 = [
            [63.0, 1.0, 1.0, 145.0, 233.0, 1.0, 2.0, 150.0, 0.0, 2.3, 3.0, 0.0, 6.0, 0],
            [67.0, 1.0, 4.0, 160.0, 286.0, 0.0, 2.0, 108.0, 1.0, 1.5, 2.0, 3.0, 3.0, 1],
            [37.0, 1.0, 3.0, 130.0, 250.0, 0.0, 0.0, 187.0, 0.0, 3.5, 3.0, 0.0, 3.0, 0],
            [67.0, 1.0, 4.0, 120.0, 229.0, 0.0, 2.0, 129.0, 1.0, 2.6, 2.0, 2.0, 7.0, 1],
            [41.0, 0.0, 2.0, 130.0, 204.0, 0.0, 2.0, 172.0, 0.0, 1.4, 1.0, 0.0, 3.0, 0],
            [56.0, 1.0, 2.0, 120.0, 236.0, 0.0, 0.0, 178.0, 0.0, 0.8, 1.0, 0.0, 3.0, 0],
            [62.0, 0.0, 4.0, 140.0, 268.0, 0.0, 2.0, 160.0, 0.0, 3.6, 3.0, 2.0, 3.0, 1],
            [57.0, 0.0, 4.0, 120.0, 354.0, 0.0, 0.0, 163.0, 1.0, 0.6, 1.0, 0.0, 3.0, 0],
            [63.0, 1.0, 4.0, 130.0, 254.0, 0.0, 2.0, 147.0, 0.0, 1.4, 2.0, 1.0, 7.0, 1],
            [53.0, 1.0, 4.0, 140.0, 203.0, 1.0, 2.0, 155.0, 1.0, 3.1, 3.0, 0.0, 7.0, 1],
            [57.0, 1.0, 4.0, 140.0, 192.0, 0.0, 0.0, 148.0, 0.0, 0.4, 2.0, 0.0, 6.0, 0]]
        point2 = [
            [53.0, 1.0, 4.0, 123.0, 282.0, 0.0, 0.0, 95.0, 1.0, 2.0, 2.0, 2.0, 7.0, 1],
            [63.0, 0.0, 4.0, 108.0, 269.0, 0.0, 0.0, 169.0, 1.0, 1.8, 2.0, 2.0, 3.0, 1],
            [34.0, 0.0, 2.0, 118.0, 210.0, 0.0, 0.0, 192.0, 0.0, 0.7, 1.0, 0.0, 3.0, 0],
            [47.0, 1.0, 4.0, 112.0, 204.0, 0.0, 0.0, 143.0, 0.0, 0.1, 1.0, 0.0, 3.0, 0],
            [67.0, 0.0, 3.0, 152.0, 277.0, 0.0, 0.0, 172.0, 0.0, 0.0, 1.0, 1.0, 3.0, 0],
            [54.0, 1.0, 4.0, 110.0, 206.0, 0.0, 2.0, 108.0, 1.0, 0.0, 2.0, 1.0, 3.0, 1],
            [66.0, 1.0, 4.0, 112.0, 212.0, 0.0, 2.0, 132.0, 1.0, 0.1, 1.0, 1.0, 3.0, 1],
            [52.0, 0.0, 3.0, 136.0, 196.0, 0.0, 2.0, 169.0, 0.0, 0.1, 2.0, 0.0, 3.0, 0],
            [55.0, 0.0, 4.0, 180.0, 327.0, 0.0, 1.0, 117.0, 1.0, 3.4, 2.0, 0.0, 3.0, 1],
            [49.0, 1.0, 3.0, 118.0, 149.0, 0.0, 2.0, 126.0, 0.0, 0.8, 1.0, 3.0, 3.0, 1],
            [74.0, 0.0, 2.0, 120.0, 269.0, 0.0, 2.0, 121.0, 1.0, 0.2, 1.0, 1.0, 3.0, 0]
        ]

        for p1, p2 in zip(point1, point2):
            self.assertEqual(self.legacy_minkowski_distance(p1, p2),
                             Distances.minkowski_distance(p1, p2))
